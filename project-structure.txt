# BG MedicApp - Sistema de GestiÃ³n Prehospitalaria

## ğŸ“‹ DescripciÃ³n del Proyecto
App multiplataforma para administrar y gestionar registros de atenciÃ³n prehospitalaria. Permite crear, manejar y exportar a PDF los registros ligados a pacientes previamente creados para agilizar el proceso con informaciÃ³n previamente aÃ±adida.

**VersiÃ³n:** 1.0.0 (en desarrollo)
**Framework:** Next.js 15.2.3 con App Router
**Base de Datos:** Firebase Firestore + LocalStorage (modo offline)
**AutenticaciÃ³n:** Firebase Auth

---

## ğŸ—ï¸ Estructura del Proyecto

```
ğŸ“ BG_MedicApp/
â”œâ”€â”€ ğŸ“ .next/                    # Build artifacts de Next.js
â”œâ”€â”€ ğŸ“ .git/                     # Control de versiones Git
â”œâ”€â”€ ğŸ“ .vscode/                  # ConfiguraciÃ³n de VS Code
â”œâ”€â”€ ğŸ“ .idx/                     # ConfiguraciÃ³n de IDX (Google Cloud)
â”œâ”€â”€ ğŸ“ node_modules/             # Dependencias de Node.js
â”œâ”€â”€ ğŸ“ docs/                     # DocumentaciÃ³n del proyecto
â”‚   â”œâ”€â”€ AUTHENTICATION_SYSTEM.md # DocumentaciÃ³n del sistema de autenticaciÃ³n
â”‚   â””â”€â”€ blueprint.md             # Plano arquitectÃ³nico del proyecto
â”œâ”€â”€ ğŸ“ src/                      # CÃ³digo fuente principal
â”‚   â”œâ”€â”€ ğŸ“ app/                  # App Router de Next.js (rutas y pÃ¡ginas)
â”‚   â”‚   â”œâ”€â”€ ğŸ“ api/              # API Routes (Backend)
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ patients/     # Endpoints para gestiÃ³n de pacientes
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ route.ts     # CRUD de pacientes
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“ prehospital-records/ # Endpoints para registros
â”‚   â”‚   â”‚       â”œâ”€â”€ route.ts     # CRUD de registros
â”‚   â”‚   â”‚       â””â”€â”€ ğŸ“ [id]/     # Rutas dinÃ¡micas por ID
â”‚   â”‚   â”‚           â””â”€â”€ route.ts # Operaciones especÃ­ficas por registro
â”‚   â”‚   â”œâ”€â”€ ğŸ“ appointments/     # GestiÃ³n de citas mÃ©dicas
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â”œâ”€â”€ ğŸ“ dashboard/        # Panel principal del sistema
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx         # Dashboard con estadÃ­sticas y navegaciÃ³n
â”‚   â”‚   â”œâ”€â”€ ğŸ“ login/            # AutenticaciÃ³n de usuarios
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx         # PÃ¡gina de inicio de sesiÃ³n
â”‚   â”‚   â”œâ”€â”€ ğŸ“ register/         # Registro de nuevos usuarios
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx         # PÃ¡gina de registro
â”‚   â”‚   â”œâ”€â”€ ğŸ“ main-menu/        # MenÃº principal de navegaciÃ³n
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â”œâ”€â”€ ğŸ“ patients/         # GestiÃ³n de pacientes
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ new/          # Crear nuevo paciente
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“ [patientId]/  # Detalles especÃ­ficos de paciente
â”‚   â”‚   â”‚       â””â”€â”€ page.tsx
â”‚   â”‚   â”œâ”€â”€ ğŸ“ prehospital-records/ # VisualizaciÃ³n de registros
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx         # Lista de todos los registros
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“ [id]/         # Detalle especÃ­fico de registro
â”‚   â”‚   â”‚       â””â”€â”€ page.tsx     # Vista detallada con todas las secciones
â”‚   â”‚   â”œâ”€â”€ ğŸ“ records/          # GestiÃ³n de registros prehospitalarios
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ new/          # Crear nuevo registro
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“ edit/         # Editar registro existente
â”‚   â”‚   â”‚       â””â”€â”€ ğŸ“ [id]/
â”‚   â”‚   â”‚           â””â”€â”€ page.tsx
â”‚   â”‚   â”œâ”€â”€ ğŸ“ reports/          # GeneraciÃ³n de reportes
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx         # Panel de reportes y estadÃ­sticas
â”‚   â”‚   â”œâ”€â”€ ğŸ“ settings/         # ConfiguraciÃ³n del sistema
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx         # Configuraciones de usuario y sistema
â”‚   â”‚   â”œâ”€â”€ ğŸ“ profile/          # Perfil de usuario
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx         # GestiÃ³n del perfil personal
â”‚   â”‚   â”œâ”€â”€ layout.tsx           # Layout principal con Header, Sidebar, Footer
â”‚   â”‚   â”œâ”€â”€ page.tsx             # PÃ¡gina de inicio (Home)
â”‚   â”‚   â”œâ”€â”€ globals.css          # Estilos globales de la aplicaciÃ³n
â”‚   â”‚   â”œâ”€â”€ actions.ts           # Server Actions de Next.js
â”‚   â”‚   â”œâ”€â”€ loading.tsx          # Componente de carga global
â”‚   â”‚   â”œâ”€â”€ error.tsx            # PÃ¡gina de error global
â”‚   â”‚   â”œâ”€â”€ not-found.tsx        # PÃ¡gina 404 personalizada
â”‚   â”‚   â””â”€â”€ favicon.ico          # Icono de la aplicaciÃ³n
â”‚   â”œâ”€â”€ ğŸ“ components/           # Componentes React reutilizables
â”‚   â”‚   â”œâ”€â”€ ğŸ“ ui/               # Sistema de diseÃ±o (Shadcn/ui)
â”‚   â”‚   â”‚   â”œâ”€â”€ accordion.tsx    # Componente de acordeÃ³n
â”‚   â”‚   â”‚   â”œâ”€â”€ alert.tsx        # Alertas y notificaciones
â”‚   â”‚   â”‚   â”œâ”€â”€ alert-dialog.tsx # DiÃ¡logos de confirmaciÃ³n
â”‚   â”‚   â”‚   â”œâ”€â”€ avatar.tsx       # Avatares de usuario
â”‚   â”‚   â”‚   â”œâ”€â”€ badge.tsx        # Badges y etiquetas
â”‚   â”‚   â”‚   â”œâ”€â”€ button.tsx       # Botones con variantes
â”‚   â”‚   â”‚   â”œâ”€â”€ calendar.tsx     # Selector de fechas
â”‚   â”‚   â”‚   â”œâ”€â”€ card.tsx         # Tarjetas de contenido
â”‚   â”‚   â”‚   â”œâ”€â”€ chart.tsx        # GrÃ¡ficos y visualizaciones
â”‚   â”‚   â”‚   â”œâ”€â”€ checkbox.tsx     # Checkboxes
â”‚   â”‚   â”‚   â”œâ”€â”€ dialog.tsx       # DiÃ¡logos modales
â”‚   â”‚   â”‚   â”œâ”€â”€ dropdown-menu.tsx # MenÃºs desplegables
â”‚   â”‚   â”‚   â”œâ”€â”€ form.tsx         # Componentes de formulario
â”‚   â”‚   â”‚   â”œâ”€â”€ input.tsx        # Campos de entrada
â”‚   â”‚   â”‚   â”œâ”€â”€ label.tsx        # Etiquetas de formulario
â”‚   â”‚   â”‚   â”œâ”€â”€ menubar.tsx      # Barras de menÃº
â”‚   â”‚   â”‚   â”œâ”€â”€ popover.tsx      # Popovers
â”‚   â”‚   â”‚   â”œâ”€â”€ progress.tsx     # Barras de progreso
â”‚   â”‚   â”‚   â”œâ”€â”€ radio-group.tsx  # Grupos de radio buttons
â”‚   â”‚   â”‚   â”œâ”€â”€ scroll-area.tsx  # Ãreas de scroll personalizadas
â”‚   â”‚   â”‚   â”œâ”€â”€ select.tsx       # Selectores dropdown
â”‚   â”‚   â”‚   â”œâ”€â”€ separator.tsx    # Separadores visuales
â”‚   â”‚   â”‚   â”œâ”€â”€ sheet.tsx        # Paneles laterales
â”‚   â”‚   â”‚   â”œâ”€â”€ sidebar.tsx      # Sidebar principal del sistema
â”‚   â”‚   â”‚   â”œâ”€â”€ skeleton.tsx     # Placeholders de carga
â”‚   â”‚   â”‚   â”œâ”€â”€ slider.tsx       # Controles deslizantes
â”‚   â”‚   â”‚   â”œâ”€â”€ switch.tsx       # Interruptores toggle
â”‚   â”‚   â”‚   â”œâ”€â”€ table.tsx        # Tablas de datos
â”‚   â”‚   â”‚   â”œâ”€â”€ tabs.tsx         # PestaÃ±as de navegaciÃ³n
â”‚   â”‚   â”‚   â”œâ”€â”€ textarea.tsx     # Ãreas de texto
â”‚   â”‚   â”‚   â”œâ”€â”€ toast.tsx        # Notificaciones toast
â”‚   â”‚   â”‚   â”œâ”€â”€ toaster.tsx      # Contenedor de toasts
â”‚   â”‚   â”‚   â””â”€â”€ tooltip.tsx      # Tooltips informativos
â”‚   â”‚   â”œâ”€â”€ AppSidebarContent.tsx # Contenido de la barra lateral
â”‚   â”‚   â”œâ”€â”€ BodyMap.tsx          # Mapa corporal para localizaciÃ³n de lesiones
â”‚   â”‚   â”œâ”€â”€ ConfirmDialog.tsx    # DiÃ¡logo de confirmaciÃ³n personalizado
â”‚   â”‚   â”œâ”€â”€ Error.tsx            # Componente de error personalizado
â”‚   â”‚   â”œâ”€â”€ Footer.tsx           # Pie de pÃ¡gina de la aplicaciÃ³n
â”‚   â”‚   â”œâ”€â”€ Header.tsx           # Encabezado con navegaciÃ³n y usuario
â”‚   â”‚   â”œâ”€â”€ Loading.tsx          # Componente de carga personalizado
â”‚   â”‚   â”œâ”€â”€ LoginForm.tsx        # Formulario de inicio de sesiÃ³n
â”‚   â”‚   â”œâ”€â”€ NetworkStatusBanner.tsx # Banner de estado de red
â”‚   â”‚   â”œâ”€â”€ PatientDetails.tsx   # Detalles del paciente (server)
â”‚   â”‚   â”œâ”€â”€ PatientDetailsClient.tsx # Detalles del paciente (client)
â”‚   â”‚   â”œâ”€â”€ PatientForm.tsx      # Formulario de creaciÃ³n/ediciÃ³n de pacientes
â”‚   â”‚   â”œâ”€â”€ PatientManagementPage.tsx # PÃ¡gina de gestiÃ³n de pacientes
â”‚   â”‚   â”œâ”€â”€ PatientSelector.tsx  # Selector de pacientes
â”‚   â”‚   â”œâ”€â”€ PatientTable.tsx     # Tabla de listado de pacientes
â”‚   â”‚   â”œâ”€â”€ PreHospitalRecordForm.tsx # Formulario principal de registros (2164 lÃ­neas)
â”‚   â”‚   â”œâ”€â”€ ProtectedRoute.tsx   # HOC para rutas protegidas
â”‚   â”‚   â”œâ”€â”€ SearchBar.tsx        # Barra de bÃºsqueda
â”‚   â”‚   â”œâ”€â”€ SessionStatus.tsx    # Estado de la sesiÃ³n de usuario
â”‚   â”‚   â”œâ”€â”€ Sidebar.tsx          # Barra lateral de navegaciÃ³n
â”‚   â”‚   â”œâ”€â”€ ThemeSelector.tsx    # Selector de tema (claro/oscuro)
â”‚   â”‚   â”œâ”€â”€ ThemeToggle.tsx      # Toggle de tema
â”‚   â”‚   â””â”€â”€ UserProfileDropdown.tsx # Dropdown del perfil de usuario
â”‚   â”œâ”€â”€ ğŸ“ hooks/                # Custom React Hooks
â”‚   â”‚   â”œâ”€â”€ use-mobile.tsx       # Hook para detectar dispositivos mÃ³viles
â”‚   â”‚   â”œâ”€â”€ use-theme.tsx        # Hook para gestiÃ³n de temas
â”‚   â”‚   â”œâ”€â”€ use-toast.ts         # Hook para notificaciones toast
â”‚   â”‚   â”œâ”€â”€ useAuth.ts           # Hook de autenticaciÃ³n principal
â”‚   â”‚   â”œâ”€â”€ useNetworkStatus.ts  # Hook para estado de conexiÃ³n
â”‚   â”‚   â”œâ”€â”€ usePatients.ts       # Hook para gestiÃ³n de pacientes
â”‚   â”‚   â””â”€â”€ usePdfGenerator.ts   # Hook para generaciÃ³n de PDFs
â”‚   â”œâ”€â”€ ğŸ“ lib/                  # LibrerÃ­as y utilidades
â”‚   â”‚   â”œâ”€â”€ ğŸ“ services/         # Servicios de negocio
â”‚   â”‚   â”‚   â””â”€â”€ patientService.ts # Servicio de gestiÃ³n de pacientes
â”‚   â”‚   â”œâ”€â”€ authService.ts       # Servicio de autenticaciÃ³n con Firebase
â”‚   â”‚   â”œâ”€â”€ firebase.ts          # ConfiguraciÃ³n de Firebase
â”‚   â”‚   â”œâ”€â”€ localDB.ts           # Base de datos local (IndexedDB)
â”‚   â”‚   â”œâ”€â”€ schema.ts            # Esquemas de validaciÃ³n con Zod
â”‚   â”‚   â”œâ”€â”€ sessionManager.ts    # GestiÃ³n de sesiones de usuario
â”‚   â”‚   â”œâ”€â”€ syncService.ts       # SincronizaciÃ³n online/offline
â”‚   â”‚   â””â”€â”€ utils.ts             # Utilidades generales
â”‚   â”œâ”€â”€ ğŸ“ ai/                   # IntegraciÃ³n con IA (Google GenKit)
â”‚   â”‚   â”œâ”€â”€ dev.ts               # ConfiguraciÃ³n de desarrollo
â”‚   â”‚   â””â”€â”€ genkit.ts            # ConfiguraciÃ³n de GenKit
â”‚   â””â”€â”€ ğŸ“ IMG/                  # Recursos de imagen
â”‚       â””â”€â”€ logo.png             # Logo de la aplicaciÃ³n
â”œâ”€â”€ ğŸ“„ README.md                 # DocumentaciÃ³n principal
â”œâ”€â”€ ğŸ“„ README_AUTH.md            # DocumentaciÃ³n del sistema de autenticaciÃ³n
â”œâ”€â”€ ğŸ“„ FIREBASE_SETUP.md         # GuÃ­a de configuraciÃ³n de Firebase
â”œâ”€â”€ ğŸ“„ package.json              # ConfiguraciÃ³n de Node.js y dependencias
â”œâ”€â”€ ğŸ“„ package-lock.json         # Lock file de dependencias
â”œâ”€â”€ ğŸ“„ tsconfig.json             # ConfiguraciÃ³n de TypeScript
â”œâ”€â”€ ğŸ“„ tsconfig.tsbuildinfo      # Cache de compilaciÃ³n TypeScript
â”œâ”€â”€ ğŸ“„ next.config.ts            # ConfiguraciÃ³n de Next.js
â”œâ”€â”€ ğŸ“„ next-env.d.ts             # Tipos de Next.js
â”œâ”€â”€ ğŸ“„ tailwind.config.ts        # ConfiguraciÃ³n de Tailwind CSS
â”œâ”€â”€ ğŸ“„ postcss.config.mjs        # ConfiguraciÃ³n de PostCSS
â”œâ”€â”€ ğŸ“„ components.json           # ConfiguraciÃ³n de Shadcn/ui
â”œâ”€â”€ ğŸ“„ env.example               # Ejemplo de variables de entorno
â”œâ”€â”€ ğŸ“„ .gitignore                # Archivos ignorados por Git
â”œâ”€â”€ ğŸ“„ Formato_registro.jpg      # Imagen de referencia del formato
â””â”€â”€ ğŸ“„ project-structure.txt     # Este archivo de estructura
```

---

## ğŸš€ TecnologÃ­as y Dependencias Principales

### **Frontend Framework**
- **Next.js 15.2.3** - Framework React con App Router
- **React 18.3.1** - LibrerÃ­a de interfaz de usuario
- **TypeScript 5** - Tipado estÃ¡tico

### **Styling y UI**
- **Tailwind CSS 3.4.1** - Framework de CSS utility-first
- **Shadcn/ui** - Sistema de componentes basado en Radix UI
- **Radix UI** - Componentes primitivos accesibles
- **Lucide React** - IconografÃ­a moderna
- **Class Variance Authority** - GestiÃ³n de variantes de componentes

### **Backend y Base de Datos**
- **Firebase 11.8.1** - Backend as a Service
  - **Firestore** - Base de datos NoSQL
  - **Firebase Auth** - Sistema de autenticaciÃ³n
- **IndexedDB** - Base de datos local para modo offline

### **Formularios y ValidaciÃ³n**
- **React Hook Form 7.54.2** - GestiÃ³n de formularios
- **Zod 3.24.2** - ValidaciÃ³n de esquemas
- **@hookform/resolvers** - IntegraciÃ³n con validadores

### **GeneraciÃ³n de PDFs**
- **jsPDF 3.0.1** - GeneraciÃ³n de documentos PDF
- **html2canvas 1.4.1** - Captura de elementos HTML

### **Estado y Datos**
- **TanStack Query 5.66.0** - GestiÃ³n de estado del servidor
- **Date-fns 3.6.0** - ManipulaciÃ³n de fechas

### **IA y AnÃ¡lisis**
- **Google GenKit 1.8.0** - Framework de IA generativa
- **Recharts 2.15.1** - GrÃ¡ficos y visualizaciones

### **Notificaciones**
- **Sonner 2.0.5** - Sistema de notificaciones toast

---

## ğŸ›ï¸ Arquitectura del Sistema

### **PatrÃ³n de Arquitectura**
- **Arquitectura por Capas** con separaciÃ³n clara de responsabilidades
- **Component-Based Architecture** con React
- **API Routes** para backend serverless

### **GestiÃ³n de Estado**
- **Local State** - React hooks (useState, useReducer)
- **Server State** - TanStack Query para cache y sincronizaciÃ³n
- **Session State** - Custom hooks para autenticaciÃ³n
- **Offline State** - IndexedDB para persistencia local

### **Flujo de Datos**
```
Frontend (React) â†” Custom Hooks â†” Services â†” Firebase/LocalDB
                              â†“
                         TanStack Query (Cache)
```

### **Sistema de AutenticaciÃ³n**
- **Firebase Auth** - AutenticaciÃ³n de usuarios
- **Session Manager** - GestiÃ³n de sesiones locales
- **Protected Routes** - Control de acceso por roles
- **Offline Support** - Funcionalidad sin conexiÃ³n

---

## ğŸ“± Funcionalidades Principales

### **GestiÃ³n de Pacientes**
- CRUD completo de pacientes
- BÃºsqueda y filtrado avanzado
- ValidaciÃ³n de datos en tiempo real
- Soporte offline

### **Registros Prehospitalarios**
- Formulario completo de 11 secciones
- Mapa corporal interactivo para lesiones
- Progreso de completado en tiempo real
- ValidaciÃ³n por pestaÃ±as
- Firmas digitales

### **GeneraciÃ³n de Reportes**
- ExportaciÃ³n a PDF de registros
- Reportes estadÃ­sticos
- VisualizaciÃ³n de datos con grÃ¡ficos

### **Sistema de Usuarios**
- AutenticaciÃ³n con email/password
- Roles de usuario (admin/user)
- GestiÃ³n de perfiles
- Control de sesiones

### **CaracterÃ­sticas TÃ©cnicas**
- **Responsive Design** - Adaptable a todos los dispositivos
- **Dark/Light Mode** - Tema dinÃ¡mico
- **Offline First** - Funcionalidad sin conexiÃ³n
- **Progressive Web App** - Instalable como app nativa
- **Real-time Sync** - SincronizaciÃ³n automÃ¡tica

---

## ğŸ”§ Scripts de Desarrollo

```bash
npm run dev          # Servidor de desarrollo (puerto 9002)
npm run build        # CompilaciÃ³n para producciÃ³n
npm run start        # Servidor de producciÃ³n
npm run lint         # Linting de cÃ³digo
npm run typecheck    # VerificaciÃ³n de tipos
npm run genkit:dev   # Desarrollo con GenKit IA
npm run genkit:watch # GenKit en modo watch
```

---

## ğŸŒ Rutas del Sistema

### **Rutas PÃºblicas**
- `/login` - Inicio de sesiÃ³n
- `/register` - Registro de usuarios

### **Rutas Protegidas**
- `/` - Dashboard principal
- `/dashboard` - Panel de control
- `/patients` - GestiÃ³n de pacientes
- `/patients/new` - Crear paciente
- `/patients/[id]` - Detalles de paciente
- `/records/new` - Crear registro
- `/records/edit/[id]` - Editar registro
- `/prehospital-records` - Lista de registros
- `/prehospital-records/[id]` - Detalle de registro
- `/reports` - GeneraciÃ³n de reportes
- `/appointments` - GestiÃ³n de citas
- `/profile` - Perfil de usuario
- `/settings` - ConfiguraciÃ³n

### **API Routes**
- `/api/patients` - CRUD de pacientes
- `/api/prehospital-records` - CRUD de registros
- `/api/prehospital-records/[id]` - Operaciones especÃ­ficas

---

## ğŸ“Š Estado del Proyecto

**VersiÃ³n Actual:** 1.0.0 (En desarrollo)
**Ãšltima ActualizaciÃ³n:** Sistema de autenticaciÃ³n completo, formulario de registros funcional, generaciÃ³n de PDFs implementada Falta mejorar el pdf para que tenga la estructura del FRAP.

